#!/usr/bin/ruby

require 'hl7-processor'

class LoggingChannel
  extend HL7Processor::Channels::Logging

  log_file "hl7.txt"

  for_all_messages do |hl7|
    log.info("Received a message:#{hl7}")
  end

end

config = HL7Processor::Configuration.new(
    port:               5900,
    message_processor:  HL7Processor::Processors::Immediate,
    channels:           [LoggingChannel]
    )
server = HL7Processor::Host.new(config)

server.start
